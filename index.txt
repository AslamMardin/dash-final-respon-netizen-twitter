<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Cache-Control" content="no-cache">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta http-equiv="Lang" content="en">
    <title>SENTIMEN ANALISIS</title>
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.3/font/bootstrap-icons.css">
</head>
<body>
    <?php include 'navbar.php';  ?>
<section class="shadow-sm bg-body pb-5 rounded">
    <figure class="text-center mt-5">
      <blockquote class="blockquote">
        <p class="display-2">SENTIMENT ANALISIS.</p>
    </blockquote>
    <figcaption class="blockquote-footer">
        Pada Web <cite title="Source Title">Universitas Al-Asyariah Mandar</cite>
    </figcaption>
    </figure>

    <div class="col-md-6 offset-3">
     <form method="GET">
        <div class="input-group mb-3">
            <input type="text" placeholder="Cari Kata..." name="q" class="form-control" /> 
            
            <button type="submit" class="btn btn-success"><i class="bi bi-search"></i> Cari</button>
        </div>
    </form>
    </div>
</section>


<?php

if(isset($_GET['q']) && $_GET['q']!='') {
    include_once(dirname(__FILE__).'/config.php');
    include_once(dirname(__FILE__).'/lib/TwitterSentimentAnalysis.php');

    $TwitterSentimentAnalysis = new TwitterSentimentAnalysis(DATUMBOX_API_KEY,TWITTER_CONSUMER_KEY,TWITTER_CONSUMER_SECRET,TWITTER_ACCESS_KEY,TWITTER_ACCESS_SECRET);

    //Search Tweets parameters as described at https://dev.twitter.com/docs/api/1.1/get/search/tweets
    $twitterSearchParams=array(
        'q'=>$_GET['q'],
        'lang'=>'in',
        'count'=>10,
    );
    $results=$TwitterSentimentAnalysis->sentimentAnalysis($twitterSearchParams);


    ?>
    <h1 class="text-center fs-4 fw-bold my-4 text-black-50"><i class="bi bi-list-columns-reverse"></i> Hasil Pencarian "<?php echo $_GET['q']; ?>" </h1>
    <table border="1" class="table table-bordered table-sm p-4">
        <thead>

            <tr>
                <td>NO</td>
                <td>PENGGUNA</td>
                <td>POSTINGAN</td>
             
                <td>SENTIMEN</td>
            </tr>
        </thead>
        <tbody>

            <?php
            $no=1;
            foreach($results as $tweet) {

                ?>
                <tr>

                    <td><?= $no++ ?></td>
                    <td><?php echo $tweet['user']; ?></td>
                    <td><?php echo $tweet['text']; ?></td>
                    
                    <td>
                        <?php

                        if ($tweet['sentiment'] == 'positive') {
                            # code...
                            echo "Positif";
                        }
                        else if($tweet['sentiment'] == 'negetive'){
                            echo "Negatif";
                        } 
                        else {
                            echo "Netral";
                        }
                        ?>
                    </td>
                </tr>
                <?php
            }
            ?>    
        </tbody>
    </table>
    <?php
}

?>

</body>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js"></script>
</html>
